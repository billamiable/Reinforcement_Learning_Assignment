digraph G {
    graph [rankdir=TB, clusterrank="local"];
    subgraph cluster_G {

        graph [style="filled,rounded",fillcolor="#80808018", label=""];
        train_policy [label="train_policy", style="filled", fillcolor="#ffffffb2", fontcolor="#000000", group="0"];
        subgraph cluster_train_policy {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy"];
            train_policy__Agent [label="Agent\n(train_policy.py:148)", style="filled", fillcolor="#feccccb2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy"];
            train_policy__build_critic [label="build_critic\n(train_policy.py:110)", style="filled", fillcolor="#feccccb2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy"];
            train_policy__build_mlp [label="build_mlp\n(train_policy.py:41)", style="filled", fillcolor="#feccccb2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy"];
            train_policy__build_policy [label="build_policy\n(train_policy.py:79)", style="filled", fillcolor="#feccccb2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy"];
            train_policy__build_rnn [label="build_rnn\n(train_policy.py:60)", style="filled", fillcolor="#feccccb2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy"];
            train_policy__discount_cumsum [label="discount_cumsum\n(train_policy.py:136)", style="filled", fillcolor="#feccccb2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy"];
            train_policy__discounted_return [label="discounted_return\n(train_policy.py:132)", style="filled", fillcolor="#feccccb2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy"];
            train_policy__main [label="main\n(train_policy.py:767)", style="filled", fillcolor="#feccccb2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy"];
            train_policy__minimize_and_clip [label="minimize_and_clip\n(train_policy.py:29)", style="filled", fillcolor="#feccccb2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy"];
            train_policy__pathlength [label="pathlength\n(train_policy.py:129)", style="filled", fillcolor="#feccccb2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy"];
            train_policy__setup_logger [label="setup_logger\n(train_policy.py:139)", style="filled", fillcolor="#feccccb2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy"];
            train_policy__train_PG [label="train_PG\n(train_policy.py:579)", style="filled", fillcolor="#feccccb2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent____init__ [label="__init__\n(train_policy.py:149)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__build_computation_graphX [label="build_computation_graph\n(train_policy.py:275)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__compute_advantage [label="compute_advantage\n(train_policy.py:424)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__define_placeholders [label="define_placeholders\n(train_policy.py:186)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__estimate_return [label="estimate_return\n(train_policy.py:473)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__get_log_prob [label="get_log_prob\n(train_policy.py:253)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__init_tf_sess [label="init_tf_sess\n(train_policy.py:179)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__policy_forward_pass [label="policy_forward_pass\n(train_policy.py:211)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__ppo_loss [label="ppo_loss\n(train_policy.py:550)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__sample_action [label="sample_action\n(train_policy.py:234)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__sample_trajectories [label="sample_trajectories\n(train_policy.py:328)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__sample_trajectory [label="sample_trajectory\n(train_policy.py:341)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__update_critic [label="update_critic\n(train_policy.py:517)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__update_parameters [label="update_parameters\n(train_policy.py:497)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__Agent {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.Agent"];
            train_policy__Agent__update_policy [label="update_policy\n(train_policy.py:538)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__main {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.main"];
            train_policy__main__train_func [label="train_func\n(train_policy.py:808)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
        subgraph cluster_train_policy__train_PG {

            graph [style="filled,rounded",fillcolor="#80808018", label="train_policy.train_PG"];
            train_policy__train_PG__unpack_sample [label="unpack_sample\n(train_policy.py:676)", style="filled", fillcolor="#ff9999b2", fontcolor="#000000", group="0"];
        }
    }
        train_policy -> train_policy__build_rnn [style="dashed", color="#838b8b"];
        train_policy -> train_policy__minimize_and_clip [style="dashed", color="#838b8b"];
        train_policy -> train_policy__setup_logger [style="dashed", color="#838b8b"];
        train_policy -> train_policy__build_mlp [style="dashed", color="#838b8b"];
        train_policy -> train_policy__discounted_return [style="dashed", color="#838b8b"];
        train_policy -> train_policy__build_policy [style="dashed", color="#838b8b"];
        train_policy -> train_policy__Agent [style="dashed", color="#838b8b"];
        train_policy -> train_policy__pathlength [style="dashed", color="#838b8b"];
        train_policy -> train_policy__train_PG [style="dashed", color="#838b8b"];
        train_policy -> train_policy__discount_cumsum [style="dashed", color="#838b8b"];
        train_policy -> train_policy__main [style="dashed", color="#838b8b"];
        train_policy -> train_policy__build_critic [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__init_tf_sess [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__estimate_return [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__build_computation_graphX [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__define_placeholders [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__sample_action [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__sample_trajectories [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__update_parameters [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__sample_trajectory [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__update_critic [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__get_log_prob [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__update_policy [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__ppo_loss [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent____init__ [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__policy_forward_pass [style="dashed", color="#838b8b"];
        train_policy__Agent -> train_policy__Agent__compute_advantage [style="dashed", color="#838b8b"];
        train_policy__train_PG -> train_policy__train_PG__unpack_sample [style="dashed", color="#838b8b"];
        train_policy__main -> train_policy__main__train_func [style="dashed", color="#838b8b"];
        train_policy -> train_policy__main [style="solid", color="#000000"];
        train_policy__build_policy -> train_policy__build_mlp [style="solid", color="#000000"];
        train_policy__build_policy -> train_policy__build_rnn [style="solid", color="#000000"];
        train_policy__build_critic -> train_policy__build_rnn [style="solid", color="#000000"];
        train_policy__build_critic -> train_policy__build_mlp [style="solid", color="#000000"];
        train_policy__setup_logger -> train_policy__train_PG [style="solid", color="#000000"];
        train_policy__Agent__policy_forward_pass -> train_policy__build_policy [style="solid", color="#000000"];
        train_policy__Agent__build_computation_graphX -> train_policy__minimize_and_clip [style="solid", color="#000000"];
        train_policy__Agent__build_computation_graphX -> train_policy__Agent__ppo_loss [style="solid", color="#000000"];
        train_policy__Agent__build_computation_graphX -> train_policy__build_critic [style="solid", color="#000000"];
        train_policy__Agent__build_computation_graphX -> train_policy__Agent__define_placeholders [style="solid", color="#000000"];
        train_policy__Agent__build_computation_graphX -> train_policy__Agent__policy_forward_pass [style="solid", color="#000000"];
        train_policy__Agent__build_computation_graphX -> train_policy__Agent__sample_action [style="solid", color="#000000"];
        train_policy__Agent__build_computation_graphX -> train_policy__Agent__get_log_prob [style="solid", color="#000000"];
        train_policy__Agent__sample_trajectories -> train_policy__Agent__sample_trajectory [style="solid", color="#000000"];
        train_policy__Agent__compute_advantage -> train_policy__Agent__define_placeholders [style="solid", color="#000000"];
        train_policy__Agent__estimate_return -> train_policy__Agent__compute_advantage [style="solid", color="#000000"];
        train_policy__Agent__update_parameters -> train_policy__Agent__update_policy [style="solid", color="#000000"];
        train_policy__Agent__update_parameters -> train_policy__Agent__update_critic [style="solid", color="#000000"];
        train_policy__Agent__update_critic -> train_policy__Agent__define_placeholders [style="solid", color="#000000"];
        train_policy__Agent__update_policy -> train_policy__minimize_and_clip [style="solid", color="#000000"];
        train_policy__Agent__update_policy -> train_policy__Agent__define_placeholders [style="solid", color="#000000"];
        train_policy__Agent__update_policy -> train_policy__Agent__ppo_loss [style="solid", color="#000000"];
        train_policy__train_PG -> train_policy__Agent__build_computation_graphX [style="solid", color="#000000"];
        train_policy__train_PG -> train_policy__setup_logger [style="solid", color="#000000"];
        train_policy__train_PG -> train_policy__Agent__sample_trajectories [style="solid", color="#000000"];
        train_policy__train_PG -> train_policy__Agent [style="solid", color="#000000"];
        train_policy__train_PG -> train_policy__Agent__update_parameters [style="solid", color="#000000"];
        train_policy__train_PG -> train_policy__Agent____init__ [style="solid", color="#000000"];
        train_policy__train_PG -> train_policy__Agent__init_tf_sess [style="solid", color="#000000"];
        train_policy__train_PG -> train_policy__Agent__estimate_return [style="solid", color="#000000"];
        train_policy__train_PG -> train_policy__Agent__define_placeholders [style="solid", color="#000000"];
        train_policy__train_PG -> train_policy__train_PG__unpack_sample [style="solid", color="#000000"];
        train_policy__train_PG -> train_policy__Agent__get_log_prob [style="solid", color="#000000"];
        train_policy__main -> train_policy__main__train_func [style="solid", color="#000000"];
        train_policy__main__train_func -> train_policy__train_PG [style="solid", color="#000000"];
    }
